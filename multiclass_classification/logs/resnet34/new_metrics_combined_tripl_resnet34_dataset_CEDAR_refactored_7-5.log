INFO:__main__:EMBED_SIZE=128; MARGIN=1.0; EPOCHS=50
BATCH_SIZE=75; RANDOM_STATE=111; DATASET=datasets/CEDAR_refactored
MODEL=resnet34; OPTIMIZER=Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    weight_decay: 1e-05
)
Triplets: combinedTRANSFORMS:Train=Compose(
      Resize(size=[224, 224], interpolation=InterpolationMode.BILINEAR, antialias=True)
      CenterCrop(size=(224, 224))
      RandomRotation(degrees=[-10.0, 10.0], interpolation=InterpolationMode.NEAREST, expand=False, fill=0)
      RandomGrayscale(p=0.05)
      ColorJitter(brightness=(0.9, 1.1), contrast=(0.9, 1.1), saturation=(0.9, 1.1))
      ToTensor()
      GaussianNoise(mean=0.0, sigma=0.1, clip=True)
      Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], inplace=False)
)Test=Compose(
      Resize(size=[224, 224], interpolation=InterpolationMode.BILINEAR, antialias=True)
      CenterCrop(size=(224, 224))
      ToTensor()
      Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], inplace=False)
)
TRAIN TEST VALIDATION SPLIT
INFO:__main__:
Epoch 21/50
INFO:__main__:Batch 0, Loss: 0.5191, Valid triplets: 26
INFO:__main__:Batch 2, Loss: 0.5100, Valid triplets: 23
INFO:__main__:Batch 4, Loss: 0.4553, Valid triplets: 34
INFO:__main__:Batch 6, Loss: 0.4452, Valid triplets: 23
INFO:__main__:Batch 8, Loss: 0.4556, Valid triplets: 28
INFO:__main__:Batch 10, Loss: 0.4445, Valid triplets: 21
INFO:__main__:Batch 12, Loss: 0.4145, Valid triplets: 34
INFO:__main__:Batch 14, Loss: 0.5278, Valid triplets: 15
INFO:__main__:Batch 16, Loss: 0.4281, Valid triplets: 23
INFO:__main__:Batch 18, Loss: 0.4204, Valid triplets: 24
INFO:__main__:Batch 20, Loss: 0.4627, Valid triplets: 21
INFO:__main__:Avg Loss: 0.4433, Valid Triplets: 519
INFO:__main__:[VALIDATION] Best Threshold for epoch 20: 2.8, F1: 0.3128, ROC-AUC: 0.9542, AP: 0.2844
INFO:__main__:TN: 119985, FP: 185, FN: 316, TP: 114
INFO:__main__:Test result for epoch 20: F1: 0.2692, ROC-AUC: 0.9475, AP: 0.2149
INFO:__main__:TN: 122452, FP: 148, FN: 357, TP: 93
INFO:__main__:EMBED_SIZE=128; MARGIN=1.0; EPOCHS=50
BATCH_SIZE=75; RANDOM_STATE=111; DATASET=datasets/CEDAR_refactored
MODEL=resnet34; OPTIMIZER=Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    weight_decay: 1e-05
)
Triplets: combinedTRANSFORMS:Train=Compose(
      Resize(size=[224, 224], interpolation=InterpolationMode.BILINEAR, antialias=True)
      CenterCrop(size=(224, 224))
      RandomRotation(degrees=[-10.0, 10.0], interpolation=InterpolationMode.NEAREST, expand=False, fill=0)
      RandomGrayscale(p=0.05)
      ColorJitter(brightness=(0.9, 1.1), contrast=(0.9, 1.1), saturation=(0.9, 1.1))
      ToTensor()
      GaussianNoise(mean=0.0, sigma=0.1, clip=True)
      Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], inplace=False)
)Test=Compose(
      Resize(size=[224, 224], interpolation=InterpolationMode.BILINEAR, antialias=True)
      CenterCrop(size=(224, 224))
      ToTensor()
      Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], inplace=False)
)
TRAIN TEST VALIDATION SPLIT
WARNING:__main__:Loaded metrics contain 21 epochs, but START_EPOCH=20. Truncating metrics.
INFO:__main__:
Epoch 21/50
INFO:__main__:Batch 0, Loss: 0.5237, Valid triplets: 26
INFO:__main__:Batch 2, Loss: 0.4313, Valid triplets: 23
INFO:__main__:Batch 4, Loss: 0.4201, Valid triplets: 35
INFO:__main__:Batch 6, Loss: 0.4416, Valid triplets: 23
INFO:__main__:Batch 8, Loss: 0.4485, Valid triplets: 29
INFO:__main__:Batch 10, Loss: 0.3133, Valid triplets: 21
INFO:__main__:Batch 12, Loss: 0.3525, Valid triplets: 32
INFO:__main__:Batch 14, Loss: 0.3810, Valid triplets: 15
INFO:__main__:Batch 16, Loss: 0.5068, Valid triplets: 22
INFO:__main__:Batch 18, Loss: 0.4060, Valid triplets: 22
INFO:__main__:Batch 20, Loss: 0.3858, Valid triplets: 20
INFO:__main__:Avg Loss: 0.4402, Valid Triplets: 511
INFO:__main__:[VALIDATION] Best Threshold for epoch 20: 2.6, F1: 0.3849, ROC-AUC: 0.9631, AP: 0.3519
INFO:__main__:TN: 119958, FP: 212, FN: 277, TP: 153
INFO:__main__:Test result for epoch 20: F1: 0.3260, ROC-AUC: 0.9547, AP: 0.3062
INFO:__main__:TN: 122362, FP: 238, FN: 316, TP: 134
INFO:__main__:Saved model and metrics at epoch 20
INFO:__main__:Прошло времени  (секунды): 226.3843982219696
INFO:__main__:
Epoch 22/50
INFO:__main__:Batch 0, Loss: 0.4281, Valid triplets: 20
INFO:__main__:Batch 2, Loss: 0.3521, Valid triplets: 18
INFO:__main__:Batch 4, Loss: 0.4366, Valid triplets: 31
INFO:__main__:Batch 6, Loss: 0.3848, Valid triplets: 18
INFO:__main__:Batch 8, Loss: 0.5218, Valid triplets: 15
INFO:__main__:Batch 10, Loss: 0.5395, Valid triplets: 16
INFO:__main__:Batch 12, Loss: 0.4610, Valid triplets: 30
INFO:__main__:Batch 14, Loss: 0.5122, Valid triplets: 12
INFO:__main__:Batch 16, Loss: 0.4096, Valid triplets: 15
INFO:__main__:Batch 18, Loss: 0.4795, Valid triplets: 17
INFO:__main__:Batch 20, Loss: 0.4470, Valid triplets: 16
INFO:__main__:Avg Loss: 0.4369, Valid Triplets: 382
INFO:__main__:[VALIDATION] Best Threshold for epoch 21: 2.8, F1: 0.4714, ROC-AUC: 0.9845, AP: 0.4799
INFO:__main__:TN: 120039, FP: 131, FN: 257, TP: 173
INFO:__main__:Test result for epoch 21: F1: 0.4598, ROC-AUC: 0.9721, AP: 0.4690
INFO:__main__:TN: 122504, FP: 96, FN: 287, TP: 163
INFO:__main__:Прошло времени  (секунды): 227.42096590995789
INFO:__main__:
Epoch 23/50
INFO:__main__:Batch 0, Loss: 0.4144, Valid triplets: 13
INFO:__main__:Batch 2, Loss: 0.4657, Valid triplets: 9
INFO:__main__:Batch 4, Loss: 0.5077, Valid triplets: 23
INFO:__main__:Batch 6, Loss: 0.3908, Valid triplets: 9
INFO:__main__:Batch 8, Loss: 0.4216, Valid triplets: 11
INFO:__main__:Batch 10, Loss: 0.4726, Valid triplets: 5
INFO:__main__:Batch 12, Loss: 0.5934, Valid triplets: 9
INFO:__main__:Batch 14, Loss: 0.4882, Valid triplets: 5
INFO:__main__:Batch 16, Loss: 0.4046, Valid triplets: 13
INFO:__main__:Batch 18, Loss: 0.4035, Valid triplets: 6
INFO:__main__:Batch 20, Loss: 0.3400, Valid triplets: 11
INFO:__main__:Avg Loss: 0.4258, Valid Triplets: 234
INFO:__main__:[VALIDATION] Best Threshold for epoch 22: 3.3, F1: 0.4785, ROC-AUC: 0.9882, AP: 0.4869
INFO:__main__:TN: 119910, FP: 260, FN: 213, TP: 217
INFO:__main__:Test result for epoch 22: F1: 0.5000, ROC-AUC: 0.9827, AP: 0.5209
INFO:__main__:TN: 122393, FP: 207, FN: 231, TP: 219
INFO:__main__:Прошло времени  (секунды): 225.10810542106628
INFO:__main__:
Epoch 24/50
INFO:__main__:Batch 0, Loss: 0.2610, Valid triplets: 8
INFO:__main__:Batch 2, Loss: 0.3881, Valid triplets: 11
INFO:__main__:Batch 4, Loss: 0.4530, Valid triplets: 20
INFO:__main__:Batch 6, Loss: 0.3967, Valid triplets: 7
INFO:__main__:Batch 8, Loss: 0.3533, Valid triplets: 5
INFO:__main__:Batch 10, Loss: 0.3425, Valid triplets: 7
INFO:__main__:Batch 12, Loss: 0.3996, Valid triplets: 7
INFO:__main__:Batch 14, Loss: 0.4612, Valid triplets: 7
INFO:__main__:Batch 16, Loss: 0.2898, Valid triplets: 4
INFO:__main__:Batch 18, Loss: 0.4722, Valid triplets: 4
INFO:__main__:Batch 20, Loss: 0.3980, Valid triplets: 6
INFO:__main__:Avg Loss: 0.4102, Valid Triplets: 151
INFO:__main__:[VALIDATION] Best Threshold for epoch 23: 3.1, F1: 0.5696, ROC-AUC: 0.9940, AP: 0.6080
INFO:__main__:TN: 120050, FP: 120, FN: 211, TP: 219
INFO:__main__:Test result for epoch 23: F1: 0.5699, ROC-AUC: 0.9877, AP: 0.5972
INFO:__main__:TN: 122513, FP: 87, FN: 236, TP: 214
INFO:__main__:Прошло времени  (секунды): 226.0324251651764
INFO:__main__:
Epoch 25/50
INFO:__main__:Batch 0, Loss: 0.4624, Valid triplets: 6
INFO:__main__:Batch 2, Loss: 0.3457, Valid triplets: 6
INFO:__main__:Batch 4, Loss: 0.2483, Valid triplets: 7
INFO:__main__:Batch 6, Loss: 0.5102, Valid triplets: 8
INFO:__main__:Batch 8, Loss: 0.2339, Valid triplets: 5
INFO:__main__:Batch 10, Loss: 0.7663, Valid triplets: 2
INFO:__main__:Batch 12, Loss: 0.8286, Valid triplets: 4
INFO:__main__:Batch 14, Loss: 0.5495, Valid triplets: 5
INFO:__main__:Batch 16, Loss: 0.5351, Valid triplets: 4
INFO:__main__:Batch 18, Loss: 0.6418, Valid triplets: 3
INFO:__main__:Batch 20, Loss: 0.4401, Valid triplets: 6
INFO:__main__:Avg Loss: 0.4618, Valid Triplets: 127
INFO:__main__:[VALIDATION] Best Threshold for epoch 24: 3.8, F1: 0.6481, ROC-AUC: 0.9954, AP: 0.6932
INFO:__main__:TN: 120016, FP: 154, FN: 150, TP: 280
INFO:__main__:Test result for epoch 24: F1: 0.6072, ROC-AUC: 0.9910, AP: 0.6433
INFO:__main__:TN: 122472, FP: 128, FN: 198, TP: 252
INFO:__main__:Saved model and metrics at epoch 24
INFO:__main__:Прошло времени  (секунды): 228.21097898483276
INFO:__main__:
Epoch 26/50
INFO:__main__:Batch 0, Loss: 0.6164, Valid triplets: 9
INFO:__main__:Batch 2, Loss: 0.3724, Valid triplets: 2
INFO:__main__:Batch 4, Loss: 0.3623, Valid triplets: 12
INFO:__main__:Batch 6, Loss: 0.2176, Valid triplets: 4
INFO:__main__:Batch 8, Loss: 0.3934, Valid triplets: 4
INFO:__main__:Batch 10, Loss: 0.3623, Valid triplets: 2
INFO:__main__:Batch 12, Loss: 0.2580, Valid triplets: 8
INFO:__main__:Batch 14, Loss: 0.6161, Valid triplets: 5
INFO:__main__:Batch 16, Loss: 0.4624, Valid triplets: 5
INFO:__main__:Batch 18, Loss: 0.2727, Valid triplets: 5
INFO:__main__:Batch 20, Loss: 0.5010, Valid triplets: 2
INFO:__main__:Avg Loss: 0.3994, Valid Triplets: 102
INFO:__main__:[VALIDATION] Best Threshold for epoch 25: 3.6, F1: 0.6954, ROC-AUC: 0.9949, AP: 0.7310
INFO:__main__:TN: 120086, FP: 84, FN: 156, TP: 274
INFO:__main__:Test result for epoch 25: F1: 0.6204, ROC-AUC: 0.9923, AP: 0.6816
INFO:__main__:TN: 122503, FP: 97, FN: 204, TP: 246
INFO:__main__:Прошло времени  (секунды): 226.12393188476562
INFO:__main__:
Epoch 27/50
INFO:__main__:Batch 0, Loss: 0.4784, Valid triplets: 7
INFO:__main__:Batch 2, Loss: 0.5526, Valid triplets: 2
INFO:__main__:Batch 4, Loss: 0.4656, Valid triplets: 9
INFO:__main__:Batch 6, Loss: 0.4907, Valid triplets: 5
INFO:__main__:Batch 8, Loss: 0.2371, Valid triplets: 3
INFO:__main__:Batch 10, Loss: 0.5053, Valid triplets: 4
INFO:__main__:Batch 12, Loss: 0.4414, Valid triplets: 8
INFO:__main__:Batch 14, Loss: 0.8332, Valid triplets: 1
INFO:__main__:Batch 16, Loss: 0.5227, Valid triplets: 4
INFO:__main__:Batch 18, Loss: 0.8405, Valid triplets: 2
INFO:__main__:Batch 20, Loss: 0.3878, Valid triplets: 4
INFO:__main__:Avg Loss: 0.4529, Valid Triplets: 89
INFO:__main__:[VALIDATION] Best Threshold for epoch 26: 4.1, F1: 0.6577, ROC-AUC: 0.9943, AP: 0.6775
INFO:__main__:TN: 120000, FP: 170, FN: 136, TP: 294
INFO:__main__:Test result for epoch 26: F1: 0.5930, ROC-AUC: 0.9924, AP: 0.6196
INFO:__main__:TN: 122426, FP: 174, FN: 187, TP: 263
INFO:__main__:Прошло времени  (секунды): 224.9455337524414
INFO:__main__:
Epoch 28/50
INFO:__main__:Batch 0, Loss: 0.4325, Valid triplets: 6
INFO:__main__:Batch 2, Loss: 0.5472, Valid triplets: 3
INFO:__main__:Batch 4, Loss: 0.3538, Valid triplets: 7
INFO:__main__:Batch 6, Loss: 0.4872, Valid triplets: 6
INFO:__main__:Batch 8, Loss: 0.4508, Valid triplets: 4
INFO:__main__:Batch 10, Loss: 0.4263, Valid triplets: 2
INFO:__main__:Batch 12, Loss: 0.4456, Valid triplets: 5
INFO:__main__:Batch 14, Loss: 0.5954, Valid triplets: 4
INFO:__main__:Batch 16, Loss: 0.4814, Valid triplets: 8
INFO:__main__:Batch 18, Loss: 0.2939, Valid triplets: 6
INFO:__main__:Batch 20, Loss: 0.2198, Valid triplets: 4
INFO:__main__:Avg Loss: 0.4224, Valid Triplets: 97
INFO:__main__:[VALIDATION] Best Threshold for epoch 27: 3.6, F1: 0.6428, ROC-AUC: 0.9943, AP: 0.6925
INFO:__main__:TN: 120032, FP: 138, FN: 161, TP: 269
INFO:__main__:Test result for epoch 27: F1: 0.6114, ROC-AUC: 0.9932, AP: 0.6539
INFO:__main__:TN: 122480, FP: 120, FN: 199, TP: 251
INFO:__main__:Прошло времени  (секунды): 222.9817430973053
INFO:__main__:
Epoch 29/50
INFO:__main__:Batch 0, Loss: 0.3845, Valid triplets: 5
INFO:__main__:Batch 2, Loss: 0.6538, Valid triplets: 1
INFO:__main__:Batch 4, Loss: 0.5422, Valid triplets: 5
INFO:__main__:Batch 6, Loss: 0.3119, Valid triplets: 3
INFO:__main__:Batch 8, Loss: 0.1804, Valid triplets: 3
INFO:__main__:Batch 12, Loss: 0.5230, Valid triplets: 4
INFO:__main__:Batch 14, Loss: 0.3500, Valid triplets: 1
INFO:__main__:Batch 20, Loss: 0.3899, Valid triplets: 1
INFO:__main__:Avg Loss: 0.4354, Valid Triplets: 52
INFO:__main__:[VALIDATION] Best Threshold for epoch 28: 4.1, F1: 0.6690, ROC-AUC: 0.9943, AP: 0.7199
INFO:__main__:TN: 120023, FP: 147, FN: 140, TP: 290
INFO:__main__:Test result for epoch 28: F1: 0.6372, ROC-AUC: 0.9937, AP: 0.6500
INFO:__main__:TN: 122464, FP: 136, FN: 176, TP: 274
INFO:__main__:Saved model and metrics at epoch 28
INFO:__main__:Прошло времени  (секунды): 222.82935285568237
INFO:__main__:
Epoch 30/50
INFO:__main__:Batch 0, Loss: 0.4120, Valid triplets: 3
INFO:__main__:Batch 2, Loss: 0.3895, Valid triplets: 4
INFO:__main__:Batch 4, Loss: 0.3309, Valid triplets: 5
INFO:__main__:Batch 6, Loss: 0.4511, Valid triplets: 3
INFO:__main__:Batch 8, Loss: 0.1878, Valid triplets: 2
INFO:__main__:Batch 10, Loss: 0.5440, Valid triplets: 3
INFO:__main__:Batch 12, Loss: 0.5211, Valid triplets: 3
INFO:__main__:Batch 14, Loss: 0.3178, Valid triplets: 5
INFO:__main__:Batch 16, Loss: 0.5842, Valid triplets: 4
INFO:__main__:Batch 18, Loss: 0.4587, Valid triplets: 3
INFO:__main__:Batch 20, Loss: 0.5072, Valid triplets: 4
INFO:__main__:Avg Loss: 0.3769, Valid Triplets: 71
INFO:__main__:[VALIDATION] Best Threshold for epoch 29: 4.3, F1: 0.6691, ROC-AUC: 0.9935, AP: 0.7225
INFO:__main__:TN: 120045, FP: 125, FN: 151, TP: 279
INFO:__main__:Test result for epoch 29: F1: 0.6344, ROC-AUC: 0.9953, AP: 0.6708
INFO:__main__:TN: 122486, FP: 114, FN: 188, TP: 262
INFO:__main__:Прошло времени  (секунды): 219.56170558929443
INFO:__main__:
Epoch 31/50
INFO:__main__:Batch 0, Loss: 0.3578, Valid triplets: 2
INFO:__main__:Batch 2, Loss: 0.5162, Valid triplets: 3
INFO:__main__:Batch 4, Loss: 0.3264, Valid triplets: 5
INFO:__main__:Batch 6, Loss: 0.3380, Valid triplets: 2
INFO:__main__:Batch 8, Loss: 0.4150, Valid triplets: 4
INFO:__main__:Batch 10, Loss: 0.2906, Valid triplets: 1
INFO:__main__:Batch 12, Loss: 0.4660, Valid triplets: 1
INFO:__main__:Batch 16, Loss: 0.4035, Valid triplets: 2
INFO:__main__:Batch 18, Loss: 0.4802, Valid triplets: 2
INFO:__main__:Batch 20, Loss: 0.1738, Valid triplets: 1
INFO:__main__:Avg Loss: 0.3794, Valid Triplets: 42
INFO:__main__:[VALIDATION] Best Threshold for epoch 30: 4.3, F1: 0.6985, ROC-AUC: 0.9959, AP: 0.7374
INFO:__main__:TN: 120054, FP: 116, FN: 137, TP: 293
INFO:__main__:Test result for epoch 30: F1: 0.6190, ROC-AUC: 0.9942, AP: 0.6586
INFO:__main__:TN: 122461, FP: 139, FN: 186, TP: 264
INFO:__main__:Прошло времени  (секунды): 207.6739706993103
INFO:__main__:
Epoch 32/50
INFO:__main__:Batch 0, Loss: 0.2020, Valid triplets: 4
INFO:__main__:Batch 4, Loss: 0.3750, Valid triplets: 3
INFO:__main__:Batch 6, Loss: 0.5446, Valid triplets: 4
INFO:__main__:Batch 8, Loss: 0.5138, Valid triplets: 2
INFO:__main__:Batch 12, Loss: 0.6449, Valid triplets: 1
INFO:__main__:Batch 14, Loss: 0.4068, Valid triplets: 2
INFO:__main__:Batch 16, Loss: 0.3017, Valid triplets: 1
INFO:__main__:Batch 18, Loss: 0.6341, Valid triplets: 1
INFO:__main__:Batch 20, Loss: 0.8554, Valid triplets: 3
INFO:__main__:Avg Loss: 0.4075, Valid Triplets: 40
INFO:__main__:[VALIDATION] Best Threshold for epoch 31: 4.3, F1: 0.6681, ROC-AUC: 0.9965, AP: 0.7037
INFO:__main__:TN: 119992, FP: 178, FN: 125, TP: 305
INFO:__main__:Test result for epoch 31: F1: 0.6358, ROC-AUC: 0.9945, AP: 0.6652
INFO:__main__:TN: 122432, FP: 168, FN: 162, TP: 288
INFO:__main__:Прошло времени  (секунды): 204.39758276939392
INFO:__main__:
Epoch 33/50
INFO:__main__:Batch 0, Loss: 0.5842, Valid triplets: 3
INFO:__main__:Batch 4, Loss: 0.4461, Valid triplets: 6
INFO:__main__:Batch 6, Loss: 0.3452, Valid triplets: 4
INFO:__main__:Batch 8, Loss: 0.1962, Valid triplets: 2
INFO:__main__:Batch 10, Loss: 0.6827, Valid triplets: 1
INFO:__main__:Batch 12, Loss: 0.6144, Valid triplets: 1
INFO:__main__:Batch 14, Loss: 0.0320, Valid triplets: 1
INFO:__main__:Batch 16, Loss: 0.4759, Valid triplets: 5
INFO:__main__:Batch 18, Loss: 0.8945, Valid triplets: 1
INFO:__main__:Batch 20, Loss: 0.0707, Valid triplets: 2
INFO:__main__:Avg Loss: 0.3830, Valid Triplets: 59
INFO:__main__:[VALIDATION] Best Threshold for epoch 32: 4.8, F1: 0.7023, ROC-AUC: 0.9950, AP: 0.7595
INFO:__main__:TN: 119968, FP: 202, FN: 88, TP: 342
INFO:__main__:Test result for epoch 32: F1: 0.6718, ROC-AUC: 0.9961, AP: 0.7269
INFO:__main__:TN: 122362, FP: 238, FN: 102, TP: 348
INFO:__main__:Saved model and metrics at epoch 32
INFO:__main__:Прошло времени  (секунды): 212.64490699768066
INFO:__main__:
Epoch 34/50
INFO:__main__:Batch 0, Loss: 0.4606, Valid triplets: 1
INFO:__main__:Batch 2, Loss: 0.6948, Valid triplets: 1
INFO:__main__:Batch 4, Loss: 0.4277, Valid triplets: 2
INFO:__main__:Batch 6, Loss: 0.1853, Valid triplets: 1
INFO:__main__:Batch 12, Loss: 0.3691, Valid triplets: 4
INFO:__main__:Batch 16, Loss: 0.0101, Valid triplets: 1
INFO:__main__:Batch 18, Loss: 0.4604, Valid triplets: 4
INFO:__main__:Batch 20, Loss: 0.4740, Valid triplets: 5
INFO:__main__:Avg Loss: 0.4250, Valid Triplets: 40
INFO:__main__:[VALIDATION] Best Threshold for epoch 33: 4.1, F1: 0.6469, ROC-AUC: 0.9918, AP: 0.7128
INFO:__main__:TN: 120006, FP: 164, FN: 146, TP: 284
INFO:__main__:Test result for epoch 33: F1: 0.6374, ROC-AUC: 0.9952, AP: 0.6814
INFO:__main__:TN: 122430, FP: 170, FN: 160, TP: 290
INFO:__main__:Прошло времени  (секунды): 200.65880680084229
INFO:__main__:
Epoch 35/50
INFO:__main__:Batch 0, Loss: 0.3942, Valid triplets: 2
INFO:__main__:Batch 2, Loss: 0.6404, Valid triplets: 2
INFO:__main__:Batch 4, Loss: 0.6561, Valid triplets: 4
INFO:__main__:Batch 8, Loss: 0.6635, Valid triplets: 3
INFO:__main__:Batch 10, Loss: 0.2611, Valid triplets: 1
INFO:__main__:Batch 12, Loss: 0.0781, Valid triplets: 1
INFO:__main__:Batch 16, Loss: 0.8534, Valid triplets: 1
INFO:__main__:Batch 18, Loss: 0.1329, Valid triplets: 1
INFO:__main__:Batch 20, Loss: 0.4074, Valid triplets: 1
INFO:__main__:Avg Loss: 0.4505, Valid Triplets: 32
INFO:__main__:[VALIDATION] Best Threshold for epoch 34: 4.3, F1: 0.6881, ROC-AUC: 0.9898, AP: 0.7166
INFO:__main__:TN: 120007, FP: 163, FN: 119, TP: 311
INFO:__main__:Test result for epoch 34: F1: 0.6758, ROC-AUC: 0.9954, AP: 0.7216
INFO:__main__:TN: 122425, FP: 175, FN: 131, TP: 319
INFO:__main__:Прошло времени  (секунды): 208.57723736763
INFO:__main__:
Epoch 36/50
INFO:__main__:Batch 0, Loss: 0.7004, Valid triplets: 2
INFO:__main__:Batch 2, Loss: 0.4316, Valid triplets: 4
INFO:__main__:Batch 4, Loss: 0.2199, Valid triplets: 3
INFO:__main__:Batch 6, Loss: 0.5020, Valid triplets: 4
INFO:__main__:Batch 8, Loss: 0.1111, Valid triplets: 1
INFO:__main__:Batch 12, Loss: 0.2452, Valid triplets: 1
INFO:__main__:Batch 14, Loss: 0.4788, Valid triplets: 3
INFO:__main__:Batch 16, Loss: 0.6974, Valid triplets: 1
INFO:__main__:Batch 18, Loss: 0.0097, Valid triplets: 2
INFO:__main__:Batch 20, Loss: 0.5098, Valid triplets: 3
INFO:__main__:Avg Loss: 0.4271, Valid Triplets: 46
INFO:__main__:[VALIDATION] Best Threshold for epoch 35: 4.3, F1: 0.6725, ROC-AUC: 0.9906, AP: 0.7111
INFO:__main__:TN: 119988, FP: 182, FN: 120, TP: 310
INFO:__main__:Test result for epoch 35: F1: 0.6499, ROC-AUC: 0.9940, AP: 0.6756
INFO:__main__:TN: 122433, FP: 167, FN: 153, TP: 297
INFO:__main__:Прошло времени  (секунды): 208.39514636993408
INFO:__main__:
Epoch 37/50
INFO:__main__:Batch 0, Loss: 0.2841, Valid triplets: 1
INFO:__main__:Batch 2, Loss: 0.0634, Valid triplets: 2
INFO:__main__:Batch 4, Loss: 0.3744, Valid triplets: 3
INFO:__main__:Batch 6, Loss: 0.5822, Valid triplets: 2
INFO:__main__:Batch 8, Loss: 0.2451, Valid triplets: 2
INFO:__main__:Batch 12, Loss: 0.3532, Valid triplets: 6
INFO:__main__:Batch 14, Loss: 0.2789, Valid triplets: 2
INFO:__main__:Batch 16, Loss: 0.3491, Valid triplets: 4
INFO:__main__:Batch 18, Loss: 0.9280, Valid triplets: 1
INFO:__main__:Avg Loss: 0.3392, Valid Triplets: 38
INFO:__main__:[VALIDATION] Best Threshold for epoch 36: 4.6, F1: 0.7557, ROC-AUC: 0.9944, AP: 0.8143
INFO:__main__:TN: 120078, FP: 92, FN: 113, TP: 317
INFO:__main__:Test result for epoch 36: F1: 0.7017, ROC-AUC: 0.9968, AP: 0.7575
INFO:__main__:TN: 122519, FP: 81, FN: 163, TP: 287
INFO:__main__:Saved model and metrics at epoch 36
INFO:__main__:Прошло времени  (секунды): 207.06688570976257
INFO:__main__:
Epoch 38/50
INFO:__main__:Batch 4, Loss: 0.2096, Valid triplets: 2
INFO:__main__:Batch 8, Loss: 0.2967, Valid triplets: 2
INFO:__main__:Batch 10, Loss: 0.1605, Valid triplets: 1
INFO:__main__:Batch 12, Loss: 0.9107, Valid triplets: 1
INFO:__main__:Batch 14, Loss: 0.6791, Valid triplets: 4
INFO:__main__:Batch 18, Loss: 0.3511, Valid triplets: 1
INFO:__main__:Batch 20, Loss: 0.3900, Valid triplets: 1
INFO:__main__:Avg Loss: 0.4265, Valid Triplets: 30
INFO:__main__:[VALIDATION] Best Threshold for epoch 37: 4.6, F1: 0.7610, ROC-AUC: 0.9960, AP: 0.8144
INFO:__main__:TN: 120105, FP: 65, FN: 126, TP: 304
INFO:__main__:Test result for epoch 37: F1: 0.6973, ROC-AUC: 0.9968, AP: 0.7624
INFO:__main__:TN: 122525, FP: 75, FN: 169, TP: 281
INFO:__main__:Прошло времени  (секунды): 204.1458613872528
INFO:__main__:
Epoch 39/50
INFO:__main__:Batch 2, Loss: 0.5480, Valid triplets: 1
INFO:__main__:Batch 4, Loss: 0.0949, Valid triplets: 2
INFO:__main__:Batch 8, Loss: 0.6773, Valid triplets: 1
INFO:__main__:Batch 14, Loss: 0.1228, Valid triplets: 1
INFO:__main__:Batch 20, Loss: 0.7843, Valid triplets: 1
INFO:__main__:Avg Loss: 0.3516, Valid Triplets: 18
INFO:__main__:[VALIDATION] Best Threshold for epoch 38: 5.1, F1: 0.7447, ROC-AUC: 0.9970, AP: 0.8015
INFO:__main__:TN: 120037, FP: 133, FN: 96, TP: 334
INFO:__main__:Test result for epoch 38: F1: 0.6912, ROC-AUC: 0.9971, AP: 0.7477
INFO:__main__:TN: 122446, FP: 154, FN: 131, TP: 319
INFO:__main__:Прошло времени  (секунды): 181.8730971813202
INFO:__main__:
Epoch 40/50
INFO:__main__:Batch 0, Loss: 0.3507, Valid triplets: 2
INFO:__main__:Batch 4, Loss: 0.6451, Valid triplets: 2
INFO:__main__:Batch 6, Loss: 0.5561, Valid triplets: 3
INFO:__main__:Batch 8, Loss: 0.1994, Valid triplets: 3
INFO:__main__:Batch 12, Loss: 0.3784, Valid triplets: 6
INFO:__main__:Batch 16, Loss: 0.2542, Valid triplets: 1
INFO:__main__:Batch 20, Loss: 0.3573, Valid triplets: 2
INFO:__main__:Avg Loss: 0.4174, Valid Triplets: 26
INFO:__main__:[VALIDATION] Best Threshold for epoch 39: 4.8, F1: 0.7279, ROC-AUC: 0.9970, AP: 0.7774
INFO:__main__:TN: 120067, FP: 103, FN: 125, TP: 305
INFO:__main__:Test result for epoch 39: F1: 0.6893, ROC-AUC: 0.9973, AP: 0.7458
INFO:__main__:TN: 122451, FP: 149, FN: 135, TP: 315
INFO:__main__:Прошло времени  (секунды): 189.5360038280487
INFO:__main__:
Epoch 41/50
INFO:__main__:Batch 4, Loss: 0.4144, Valid triplets: 2
INFO:__main__:Batch 6, Loss: 0.2883, Valid triplets: 1
INFO:__main__:Batch 14, Loss: 0.2138, Valid triplets: 1
INFO:__main__:Batch 16, Loss: 0.0930, Valid triplets: 1
INFO:__main__:Batch 18, Loss: 0.3558, Valid triplets: 1
INFO:__main__:Batch 20, Loss: 0.5071, Valid triplets: 2
INFO:__main__:Avg Loss: 0.3893, Valid Triplets: 25
INFO:__main__:[VALIDATION] Best Threshold for epoch 40: 4.8, F1: 0.6986, ROC-AUC: 0.9965, AP: 0.7525
INFO:__main__:TN: 120056, FP: 114, FN: 138, TP: 292
INFO:__main__:Test result for epoch 40: F1: 0.6905, ROC-AUC: 0.9961, AP: 0.7108
INFO:__main__:TN: 122483, FP: 117, FN: 151, TP: 299
INFO:__main__:Saved model and metrics at epoch 40
INFO:__main__:Прошло времени  (секунды): 190.23562502861023
INFO:__main__:
Epoch 42/50
INFO:__main__:Batch 0, Loss: 0.8267, Valid triplets: 1
INFO:__main__:Batch 2, Loss: 0.3340, Valid triplets: 1
INFO:__main__:Batch 4, Loss: 0.4498, Valid triplets: 5
INFO:__main__:Batch 8, Loss: 0.2815, Valid triplets: 2
INFO:__main__:Batch 12, Loss: 0.4818, Valid triplets: 4
INFO:__main__:Batch 14, Loss: 0.1614, Valid triplets: 1
INFO:__main__:Batch 16, Loss: 0.6061, Valid triplets: 4
INFO:__main__:Batch 18, Loss: 0.0954, Valid triplets: 2
INFO:__main__:Avg Loss: 0.5051, Valid Triplets: 33
INFO:__main__:[VALIDATION] Best Threshold for epoch 41: 4.8, F1: 0.7179, ROC-AUC: 0.9964, AP: 0.7434
INFO:__main__:TN: 120091, FP: 79, FN: 145, TP: 285
INFO:__main__:Test result for epoch 41: F1: 0.6659, ROC-AUC: 0.9961, AP: 0.6900
INFO:__main__:TN: 122493, FP: 107, FN: 172, TP: 278
INFO:__main__:Прошло времени  (секунды): 199.43959522247314
INFO:__main__:
Epoch 43/50
INFO:__main__:Batch 2, Loss: 0.4475, Valid triplets: 2
INFO:__main__:Batch 4, Loss: 0.7177, Valid triplets: 1
INFO:__main__:Batch 6, Loss: 0.2925, Valid triplets: 2
INFO:__main__:Batch 10, Loss: 0.0255, Valid triplets: 1
INFO:__main__:Batch 18, Loss: 0.5686, Valid triplets: 1
INFO:__main__:Batch 20, Loss: 0.4323, Valid triplets: 1
INFO:__main__:Avg Loss: 0.4515, Valid Triplets: 18
INFO:__main__:[VALIDATION] Best Threshold for epoch 42: 4.8, F1: 0.7248, ROC-AUC: 0.9976, AP: 0.7646
INFO:__main__:TN: 120037, FP: 133, FN: 110, TP: 320
INFO:__main__:Test result for epoch 42: F1: 0.6667, ROC-AUC: 0.9975, AP: 0.7148
INFO:__main__:TN: 122404, FP: 196, FN: 127, TP: 323
INFO:__main__:Прошло времени  (секунды): 178.9083776473999
INFO:__main__:
Epoch 44/50
INFO:__main__:Batch 0, Loss: 0.0162, Valid triplets: 1
INFO:__main__:Batch 2, Loss: 0.2420, Valid triplets: 3
INFO:__main__:Batch 4, Loss: 0.4838, Valid triplets: 1
INFO:__main__:Batch 8, Loss: 0.4692, Valid triplets: 1
INFO:__main__:Batch 10, Loss: 0.9171, Valid triplets: 1
INFO:__main__:Batch 12, Loss: 0.3525, Valid triplets: 1
INFO:__main__:Avg Loss: 0.3376, Valid Triplets: 12
INFO:__main__:[VALIDATION] Best Threshold for epoch 43: 4.3, F1: 0.7189, ROC-AUC: 0.9978, AP: 0.7686
INFO:__main__:TN: 120069, FP: 101, FN: 132, TP: 298
INFO:__main__:Test result for epoch 43: F1: 0.6834, ROC-AUC: 0.9975, AP: 0.7176
INFO:__main__:TN: 122474, FP: 126, FN: 151, TP: 299
INFO:__main__:Прошло времени  (секунды): 166.7814507484436
INFO:__main__:
Epoch 45/50
INFO:__main__:Batch 0, Loss: 0.7063, Valid triplets: 2
INFO:__main__:Batch 4, Loss: 0.1187, Valid triplets: 1
INFO:__main__:Batch 8, Loss: 0.0804, Valid triplets: 1
INFO:__main__:Batch 12, Loss: 0.0446, Valid triplets: 1
INFO:__main__:Batch 18, Loss: 0.3056, Valid triplets: 1
INFO:__main__:Batch 20, Loss: 0.3137, Valid triplets: 2
INFO:__main__:Avg Loss: 0.3343, Valid Triplets: 14
INFO:__main__:[VALIDATION] Best Threshold for epoch 44: 4.6, F1: 0.7338, ROC-AUC: 0.9985, AP: 0.7930
INFO:__main__:TN: 120034, FP: 136, FN: 102, TP: 328
INFO:__main__:Test result for epoch 44: F1: 0.7055, ROC-AUC: 0.9985, AP: 0.7468
INFO:__main__:TN: 122450, FP: 150, FN: 123, TP: 327
INFO:__main__:Saved model and metrics at epoch 44
INFO:__main__:Прошло времени  (секунды): 173.15051698684692
INFO:__main__:
Epoch 46/50
INFO:__main__:Batch 4, Loss: 0.5281, Valid triplets: 2
INFO:__main__:Batch 6, Loss: 0.3142, Valid triplets: 1
INFO:__main__:Batch 8, Loss: 0.4057, Valid triplets: 1
INFO:__main__:Avg Loss: 0.3283, Valid Triplets: 16
INFO:__main__:[VALIDATION] Best Threshold for epoch 45: 4.6, F1: 0.7185, ROC-AUC: 0.9984, AP: 0.7812
INFO:__main__:TN: 120056, FP: 114, FN: 125, TP: 305
INFO:__main__:Test result for epoch 45: F1: 0.6819, ROC-AUC: 0.9983, AP: 0.7358
INFO:__main__:TN: 122472, FP: 128, FN: 151, TP: 299
INFO:__main__:Прошло времени  (секунды): 172.62647914886475
INFO:__main__:
Epoch 47/50
INFO:__main__:Batch 6, Loss: 0.1970, Valid triplets: 1
INFO:__main__:Batch 8, Loss: 0.4513, Valid triplets: 1
INFO:__main__:Batch 12, Loss: 0.4412, Valid triplets: 1
INFO:__main__:Batch 14, Loss: 0.2893, Valid triplets: 1
INFO:__main__:Avg Loss: 0.4299, Valid Triplets: 19
INFO:__main__:[VALIDATION] Best Threshold for epoch 46: 4.6, F1: 0.7257, ROC-AUC: 0.9979, AP: 0.7950
INFO:__main__:TN: 120082, FP: 88, FN: 135, TP: 295
INFO:__main__:Test result for epoch 46: F1: 0.6884, ROC-AUC: 0.9982, AP: 0.7449
INFO:__main__:TN: 122488, FP: 112, FN: 155, TP: 295
INFO:__main__:Прошло времени  (секунды): 176.20624661445618
INFO:__main__:
Epoch 48/50
INFO:__main__:Batch 4, Loss: 0.3058, Valid triplets: 1
INFO:__main__:Batch 14, Loss: 0.6154, Valid triplets: 3
INFO:__main__:Batch 16, Loss: 0.7984, Valid triplets: 1
INFO:__main__:Batch 18, Loss: 0.0882, Valid triplets: 1
INFO:__main__:Batch 20, Loss: 0.0272, Valid triplets: 1
INFO:__main__:Avg Loss: 0.3739, Valid Triplets: 11
INFO:__main__:[VALIDATION] Best Threshold for epoch 47: 4.6, F1: 0.7155, ROC-AUC: 0.9971, AP: 0.7925
INFO:__main__:TN: 120056, FP: 114, FN: 127, TP: 303
INFO:__main__:Test result for epoch 47: F1: 0.6825, ROC-AUC: 0.9977, AP: 0.7237
INFO:__main__:TN: 122469, FP: 131, FN: 149, TP: 301
INFO:__main__:Прошло времени  (секунды): 166.90439176559448
INFO:__main__:
Epoch 49/50
INFO:__main__:Batch 2, Loss: 0.2282, Valid triplets: 1
INFO:__main__:Batch 4, Loss: 0.1092, Valid triplets: 2
INFO:__main__:Batch 10, Loss: 0.4425, Valid triplets: 1
INFO:__main__:Batch 16, Loss: 0.4046, Valid triplets: 1
INFO:__main__:Batch 18, Loss: 0.2118, Valid triplets: 1
INFO:__main__:Avg Loss: 0.3227, Valid Triplets: 12
INFO:__main__:[VALIDATION] Best Threshold for epoch 48: 4.6, F1: 0.7374, ROC-AUC: 0.9969, AP: 0.7912
INFO:__main__:TN: 120035, FP: 135, FN: 100, TP: 330
INFO:__main__:Test result for epoch 48: F1: 0.6845, ROC-AUC: 0.9980, AP: 0.7407
INFO:__main__:TN: 122437, FP: 163, FN: 131, TP: 319
INFO:__main__:Saved model and metrics at epoch 48
INFO:__main__:Прошло времени  (секунды): 170.0246353149414
INFO:__main__:
Epoch 50/50
INFO:__main__:Batch 0, Loss: 0.7786, Valid triplets: 1
INFO:__main__:Batch 6, Loss: 0.4650, Valid triplets: 1
INFO:__main__:Batch 12, Loss: 0.5028, Valid triplets: 1
INFO:__main__:Avg Loss: 0.4058, Valid Triplets: 6
INFO:__main__:The number of triplets is less than 10. Start including hard triplets
INFO:__main__:[VALIDATION] Best Threshold for epoch 49: 4.3, F1: 0.7222, ROC-AUC: 0.9969, AP: 0.7871
INFO:__main__:TN: 120055, FP: 115, FN: 122, TP: 308
INFO:__main__:Test result for epoch 49: F1: 0.6789, ROC-AUC: 0.9979, AP: 0.7382
INFO:__main__:TN: 122474, FP: 126, FN: 154, TP: 296
INFO:__main__:Saved model and metrics at epoch 49
INFO:__main__:Прошло времени  (секунды): 151.69858503341675
INFO:__main__:BEST METRICS:
{'f1_score': 0.7055016181229773, 'roc_auc': 0.9985060540148631, 'average_precision': 0.7468329100494457, 'epoch': 44, 'true_negative': 122450, 'false_positive': 150, 'false_negative': 123, 'true_positive': 327, 'threshold': 4.599999999999999}
